<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>POTATO</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/night-owl.css">
</head>
<body>
  <!-- Toolbar -->
  <header class="toolbar">
    <button class="menu-btn" id="menu-btn" title="Menu">&#9776;</button>
    <span class="toolbar-title" id="note-title"></span>
    <div class="toolbar-spacer"></div>
    <div class="toolbar-search" id="toolbar-search">
      <span class="toolbar-search-icon">&#9906;</span>
      <input type="text" class="toolbar-search-input" id="toolbar-search-input" placeholder="Buscar..." autocomplete="off" spellcheck="false">
      <kbd class="toolbar-search-hint">Ctrl+P</kbd>
    </div>
    <div class="font-size-controls hidden" id="font-size-controls">
      <button class="font-size-btn" id="font-size-down" title="Reducir fuente">&#8722;</button>
      <span class="font-size-label" id="font-size-label">14</span>
      <button class="font-size-btn" id="font-size-up" title="Aumentar fuente">&#43;</button>
    </div>
    <button class="claude-toggle-btn hidden" id="claude-toggle-btn" title="Claude (Ctrl+L)"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M8 1l1.5 3.5L13 6l-3.5 1.5L8 11 6.5 7.5 3 6l3.5-1.5z"/><path d="M12 10l.75 1.75L14.5 12.5l-1.75.75L12 15l-.75-1.75-1.75-.75 1.75-.75z"/></svg></button>
    <button class="split-btn hidden" id="split-btn" title="Vista dividida"><svg width="16" height="14" viewBox="0 0 16 14" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="1" y="1" width="14" height="12" rx="1.5"/><line x1="8" y1="1" x2="8" y2="13"/></svg></button>
    <button class="close-note-btn hidden" id="close-note-btn" title="Cerrar nota">&times;</button>
    <div class="mode-toggle hidden" id="mode-toggle">
      <button class="toggle-btn" data-mode="edit">Edit</button>
      <button class="toggle-btn active" data-mode="read">Read</button>
    </div>
    <button class="sync-btn hidden" id="sync-btn" title="Sincronizar con GitHub">
      <span class="sync-icon">&#8635;</span>
      <span class="sync-label" id="sync-label">Sync</span>
    </button>
  </header>

  <!-- Dropdown Menu -->
  <div class="menu-dropdown" id="menu-dropdown">
    <div class="menu-item" id="menu-open-vault">
      <span class="menu-icon">&#9707;</span>
      <span>Abrir vault</span>
      <span class="menu-shortcut">Ctrl+O</span>
    </div>
    <div class="menu-item" id="menu-new-note">
      <span class="menu-icon">&#43;</span>
      <span>Nueva nota</span>
      <span class="menu-shortcut">Ctrl+N</span>
    </div>
    <div class="menu-separator"></div>
    <div class="menu-item" id="menu-github">
      <span class="menu-icon">&#8595;</span>
      <span>Clonar repositorio GitHub</span>
    </div>
    <div class="menu-item" id="menu-sync">
      <span class="menu-icon">&#8645;</span>
      <span>Sincronizar</span>
      <span class="menu-shortcut">Ctrl+Shift+S</span>
    </div>
    <div class="menu-item" id="menu-open-folder">
      <span class="menu-icon">&#8599;</span>
      <span>Abrir en explorador</span>
    </div>
    <div class="menu-separator"></div>
    <div class="menu-item" id="menu-settings">
      <span class="menu-icon">&#9675;</span>
      <span>Ajustes</span>
    </div>
  </div>

  <!-- New Note Modal -->
  <div class="modal-overlay" id="newnote-modal">
    <div class="modal">
      <div class="modal-header">
        <span class="modal-title">Nueva nota</span>
        <button class="modal-close" id="newnote-modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="sync-step">
          <div class="sync-step-label">Nombre de la nota:</div>
          <input type="text" class="sync-input" id="newnote-input" placeholder="Mi nueva nota" spellcheck="false" autocomplete="off">
        </div>
      </div>
      <div class="modal-footer">
        <button class="modal-btn secondary" id="newnote-btn-cancel">Cancelar</button>
        <button class="modal-btn primary" id="newnote-btn-action">Crear</button>
      </div>
    </div>
  </div>

  <!-- Clone Modal -->
  <div class="modal-overlay" id="clone-modal">
    <div class="modal">
      <div class="modal-header">
        <span class="modal-title">Clonar repositorio</span>
        <button class="modal-close" id="clone-modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="sync-step">
          <div class="sync-step-label">SSH del repositorio:</div>
          <input type="text" class="sync-input" id="clone-url-input" placeholder="git@github.com:usuario/mi-vault.git" spellcheck="false" autocomplete="off">
          <div class="clone-hint">Copia el SSH desde tu repositorio en GitHub.</div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="modal-btn secondary" id="clone-btn-cancel">Cancelar</button>
        <button class="modal-btn primary" id="clone-btn-action">Clonar</button>
      </div>
    </div>
  </div>

  <!-- Search palette -->
  <div class="search-overlay" id="search-overlay">
    <div class="search-palette">
      <div class="search-input-wrap">
        <span class="search-icon">&#9906;</span>
        <input type="text" class="search-input" id="search-input" placeholder="Buscar notas y contenido..." autocomplete="off" spellcheck="false">
      </div>
      <div class="search-results" id="search-results"></div>
    </div>
  </div>

  <!-- Progress bar -->
  <div class="progress-bar" id="progress-bar">
    <div class="progress-fill" id="progress-fill"></div>
    <span class="progress-text" id="progress-text"></span>
  </div>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-resize" id="sidebar-resize"></div>
    <div class="sidebar-header" id="vault-name">VAULT</div>
    <div class="sidebar-tree" id="file-tree">
      <div class="sidebar-empty">Ctrl+O para abrir un vault</div>
    </div>
  </aside>

  <!-- Content: Editor -->
  <main class="content">
    <div class="compact-note-resize" id="compact-note-resize"></div>
    <textarea
      class="editor"
      id="editor"
      spellcheck="false"
      placeholder="Escribe algo..."
    ></textarea>
    <div class="preview" id="preview"></div>
    <aside class="toc-panel hidden" id="toc-panel">
      <div class="toc-header">Indice</div>
      <nav class="toc-list" id="toc-list"></nav>
    </aside>
  </main>

  <!-- Claude Panel -->
  <aside class="claude-panel hidden" id="claude-panel">
    <div class="claude-header">
      <span class="claude-title">Claude</span>
      <select class="claude-model-select" id="claude-model-select">
        <option value="claude-sonnet-4-5-20250929">Sonnet 4.5</option>
        <option value="claude-opus-4-6">Opus 4.6</option>
        <option value="claude-haiku-4-5-20251001">Haiku 4.5</option>
      </select>
      <button class="claude-history-btn" id="claude-history-btn" title="Historial">&#9776;</button>
      <button class="claude-new-btn" id="claude-new-btn" title="Nuevo chat">+</button>
      <button class="claude-maximize-btn" id="claude-maximize-btn" title="Maximizar"><svg width="13" height="13" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 1 1 1 1 4"/><polyline points="12 1 15 1 15 4"/><polyline points="4 15 1 15 1 12"/><polyline points="12 15 15 15 15 12"/></svg></button>
      <button class="claude-minimize-btn" id="claude-minimize-btn" title="Minimizar">&#8213;</button>
      <button class="claude-close-btn" id="claude-close-btn">&times;</button>
    </div>
    <div class="claude-messages" id="claude-messages"></div>
    <div class="claude-history" id="claude-history">
      <div class="claude-history-header">
        <span class="claude-history-title">Historial de chats</span>
        <button class="claude-history-close" id="claude-history-close">&times;</button>
      </div>
      <div class="claude-history-list" id="claude-history-list"></div>
    </div>
    <div class="claude-context-bar" id="claude-context-bar">
      <select class="claude-mode-select" id="claude-mode-select">
        <option value="vault">Vault</option>
        <option value="project">Proyecto</option>
      </select>
      <span class="claude-context-name" id="claude-context-name"></span>
    </div>
    <div class="claude-input-area">
      <textarea class="claude-input" id="claude-input" placeholder="Preguntale a Claude..." rows="1"></textarea>
      <button class="claude-send-btn" id="claude-send-btn" title="Enviar">&#9654;</button>
      <button class="claude-stop-btn hidden" id="claude-stop-btn" title="Detener">&#9632;</button>
    </div>
  </aside>

  <!-- Claude minimized pill -->
  <div class="claude-minimized-pill" id="claude-minimized-pill">
    <svg width="14" height="14" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M8 1l1.5 3.5L13 6l-3.5 1.5L8 11 6.5 7.5 3 6l3.5-1.5z"/><path d="M12 10l.75 1.75L14.5 12.5l-1.75.75L12 15l-.75-1.75-1.75-.75 1.75-.75z"/></svg>
    <span>Claude</span>
  </div>

  <!-- Status bar -->
  <footer class="statusbar">
    <span id="status-text">Ctrl+O para abrir un vault</span>
    <span class="statusbar-spacer"></span>
    <span class="statusbar-credit">by JemXiaoLong</span>
  </footer>

  <!-- Sync Modal -->
  <div class="modal-overlay" id="sync-modal">
    <div class="modal">
      <div class="modal-header">
        <span class="modal-title">Sincronizar</span>
        <button class="modal-close" id="sync-modal-close">&times;</button>
      </div>
      <div class="modal-body" id="sync-modal-body">
        <!-- Step 1: Pull status -->
        <div class="sync-step" id="sync-step-pull">
          <div class="sync-step-icon">&#8635;</div>
          <div class="sync-step-text">Descargando cambios...</div>
        </div>
        <!-- Step 2: File list -->
        <div class="sync-step hidden" id="sync-step-files">
          <div class="sync-step-label">Archivos con cambios locales:</div>
          <div class="sync-file-actions">
            <button class="sync-select-btn" id="sync-select-all">Todos</button>
            <button class="sync-select-btn" id="sync-select-none">Ninguno</button>
          </div>
          <div class="sync-file-list" id="sync-file-list"></div>
        </div>
        <!-- Step 3: Commit message -->
        <div class="sync-step hidden" id="sync-step-commit">
          <div class="sync-step-label">Mensaje del commit:</div>
          <input type="text" class="sync-input" id="sync-commit-msg" placeholder="Describe tus cambios...">
        </div>
        <!-- Step 4: Result -->
        <div class="sync-step hidden" id="sync-step-result">
          <div class="sync-step-icon" id="sync-result-icon">&#10003;</div>
          <div class="sync-step-text" id="sync-result-text">Sincronizado</div>
        </div>
      </div>
      <div class="modal-footer" id="sync-modal-footer">
        <button class="modal-btn secondary" id="sync-btn-cancel">Cancelar</button>
        <button class="modal-btn primary" id="sync-btn-action">Continuar</button>
      </div>
    </div>
  </div>

  <!-- Settings Modal (placeholder) -->
  <div class="modal-overlay" id="settings-modal">
    <div class="modal">
      <div class="modal-header">
        <span class="modal-title">Ajustes</span>
        <button class="modal-close" id="settings-modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="settings-section">
          <div class="settings-row">
            <div class="settings-row-info">
              <span class="settings-row-label">Indicadores de sync</span>
              <span class="settings-row-desc">Iluminar en verde los archivos sin sincronizar</span>
            </div>
            <label class="switch">
              <input type="checkbox" id="setting-sync-indicators" checked>
              <span class="switch-slider"></span>
            </label>
          </div>
          <div class="settings-row">
            <div class="settings-row-info">
              <span class="settings-row-label">Auto-guardado</span>
              <span class="settings-row-desc">Guardar automaticamente al dejar de escribir</span>
            </div>
            <label class="switch">
              <input type="checkbox" id="setting-autosave" checked>
              <span class="switch-slider"></span>
            </label>
          </div>
          <div class="settings-row">
            <div class="settings-row-info">
              <span class="settings-row-label">Indice de nota</span>
              <span class="settings-row-desc">Mostrar tabla de contenido con los encabezados</span>
            </div>
            <label class="switch">
              <input type="checkbox" id="setting-toc">
              <span class="switch-slider"></span>
            </label>
          </div>
        </div>
        <div class="settings-section-title">Claude</div>
        <div class="settings-section">
          <div class="settings-row">
            <div class="settings-row-info">
              <span class="settings-row-label">Directorio de agentes</span>
              <span class="settings-row-desc">Carpeta para cargar agentes custom (.claude/agents)</span>
              <div class="settings-path-row">
                <input type="text" class="settings-path-input" id="setting-claude-workdir-input" placeholder="Usando vault" spellcheck="false" autocomplete="off">
                <button class="settings-action-btn" id="setting-claude-workdir-btn" title="Explorar">Cambiar</button>
              </div>
            </div>
          </div>
          <div class="settings-row">
            <div class="settings-row-info">
              <span class="settings-row-label">Directorio de proyecto</span>
              <span class="settings-row-desc">Carpeta del codigo fuente para revisar y crear documentacion</span>
              <div class="settings-path-row">
                <input type="text" class="settings-path-input" id="setting-claude-projectdir-input" placeholder="No configurado" spellcheck="false" autocomplete="off">
                <button class="settings-action-btn" id="setting-claude-projectdir-btn" title="Explorar">Cambiar</button>
              </div>
            </div>
          </div>
        </div>
        <div class="settings-soon">
          <div class="settings-soon-icon">&#9675;</div>
          <div class="settings-soon-title">Proximamente</div>
          <div class="settings-soon-list">
            <div class="settings-soon-item">Tema claro / oscuro</div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="modal-btn primary" id="settings-btn-close">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Move File Confirmation Modal -->
  <div class="modal-overlay" id="move-modal">
    <div class="modal">
      <div class="modal-header">
        <span class="modal-title">Mover archivo</span>
        <button class="modal-close" id="move-modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="move-confirm-msg">
          <div class="move-confirm-icon">&#8623;</div>
          <div class="move-confirm-text">
            <span>Mover</span>
            <strong id="move-file-name"></strong>
            <span>a la carpeta</span>
            <strong id="move-dest-name"></strong>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="modal-btn secondary" id="move-btn-cancel">Cancelar</button>
        <button class="modal-btn primary" id="move-btn-action">Mover</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/vendor/marked.min.js"></script>
  <script src="js/vendor/highlight.min.js"></script>
  <script src="js/wikilinks.js"></script>
  <script src="js/sidebar.js"></script>
  <script src="js/editor.js"></script>
  <script src="js/preview.js"></script>
  <script src="js/claude.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
